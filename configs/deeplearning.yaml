namespace: gpn-mizzou-jhurt

defaults:
  image: gitlab-registry.nrp-nautilus.io/jhurt/mmdetection:208c1d5b
  volumes:
    jhurt-data: /data
    jhurt-experiments: /output
  ports:
    - 8880
  env:
    MMDET_GPU_IDS: all
    MMDET_BATCH_SIZE: 2
    NCCL_SOCKET_IFNAME: eth0
    NCCL_DEBUG: INFO
    CUDA_HOME: /usr/local/cuda
    MKL_THREADING_LAYER: GNU
  command: ["python", "-m", "cgimmd", "train", "./train_cfg.py"]
  min_ram: 8
  max_ram: 64
  min_cpu: 8
  max_cpu: 16
  gpu: 4
  shm: True

jobs:
  - 
    job_name: train-ssd-rareplanes
    workingDir: /output/RarePlanes/ssd
    env:
      MMDET_WORK_DIR: /output/RarePlanes/ssd/train_output_2_TEST
  - 
    job_name: train-ssd-dota
    workingDir: /output/DOTA/ssd
    env:
      MMDET_WORK_DIR: /output/DOTA/ssd/train_output_2_TEST
